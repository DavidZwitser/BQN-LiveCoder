# A "closured namespace" that deals with replicating the repeat behaviour keyboards excibit when holding a key
RepeatKey â‡ {ğ•Šrepeat_delayâ€¿repeat_interval:
	âŸ¨was_down, down_time, last_repeatâŸ© â† 3â¥Š0
	last_time â† â€¢MonoTime@

	Do â‡ {ğ•Šdown:
		should_type â† 0 â‹„ delta_time â† (â€¢MonoTime@) - last_time
		{down ? down_time +â†© delta_time ; down_time â†© 0}

		# First press
		{down âˆ§ Â¬was_down ? should_type â†© 1 ; 0}

		# Repeat
		{(down_time > repeat_delay) âˆ§ ((â€¢MonoTime@) - last_repeat) > repeat_interval ?
			last_repeat â†© â€¢MonoTime@, should_type â†© 1 ; @
		}

		was_down â†© down â‹„ last_time â†© â€¢MonoTime@
		should_type
	}
}

ErrorSafe â‡ {ğ•Šmsg:
	par_cacheâ†@
	res_cacheâ†@
	_try â‡ {Func _ğ•£ âŸ¨passed_errâ‹„parsâŸ©:
		new_errâ†@ â‹„ resâ†FuncâŠ{ğ•Š:new_errâ†© âˆ¾âŸœ(â€¢Fmt pars) msgâˆ¾â€¢CurrentError@} pars
		error â† {passed_errâ‰¢@?passed_err;new_err}
		{new_errâ‰¢@ ?
			{par_cacheâ‰¡@?
				âŸ¨errorâ‹„@âŸ© ;
				âŸ¨errorâ‹„ FuncâŠ{res_cacheâ‰¢@?res_cache;@} par_cacheâŸ©
			}
			; par_cacheâ†©pars â‹„ âŸ¨errorâ‹„res_cacheâ†©resâŸ©
		}
	}
}
